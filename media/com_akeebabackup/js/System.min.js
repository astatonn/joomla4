"use strict";window.akeebabackup=window.akeebabackup||{},window.akeebabackup.Ajax=window.akeebabackup.Ajax||{xhrSuccessStatus:{0:200,1223:204},requestArray:[],processingQueue:!1,ajax:function ajax(a,b){"undefined"==typeof b&&(b=a,a=b.url);var c="undefined"==typeof b.type?"POST":b.type;c=c.toUpperCase();var d="undefined"==typeof b.data?{}:b.data,e=null,f="undefined"==typeof b.success?null:b.success,g="undefined"==typeof b.error?null:b.error,h="undefined"!=typeof b.cache&&b.url;if(!h){var i=new Date().getTime()/1e3,j=parseInt(i,10);d._cacheBustingJunk=Math.round(1e3*(i-j))/1e3}"POST"===c||"PUT"===c?e=this.interpolateParameters(d):(a+=-1===a.indexOf("?")?"?":"&",a+=this.interpolateParameters(d));var k=new XMLHttpRequest;k.open(c,a),("POST"===c||"PUT"===c)&&k.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),k.onload=function(){var a=akeebabackup.Ajax.xhrSuccessStatus[k.status]||k.status,b=k.statusText,c="text"!==(k.responseType||"text")||"string"!=typeof k.responseText,d=c?k.response:k.responseText,e=k.getAllResponseHeaders();return 200===a?void(null!=f&&akeebabackup.Ajax.triggerCallbacks(f,d,b,k)):void(g&&akeebabackup.Ajax.triggerCallbacks(g,k,"error",null))},k.onerror=function(){g&&akeebabackup.Ajax.triggerCallbacks(g,k,"error",null)},window.attachEvent&&!window.addEventListener&&(k.onreadystatechange=function(){if(4===this.readyState){var a=akeebabackup.Ajax.xhrSuccessStatus[this.status]||this.status;200<=a&&400>a?k.onload():k.onerror()}}),k.ontimeout=function(){g&&akeebabackup.Ajax.triggerCallbacks(g,k,"timeout",null)},k.onabort=function(){g&&akeebabackup.Ajax.triggerCallbacks(g,k,"abort",null)};var l="undefined"==typeof b.timeout?6e5:b.timeout;0<l&&(k.timeout=l);"undefined"!=typeof b.beforeSend&&!1===b.beforeSend(k,b)||k.send(e)},enqueue:function enqueue(a,b){"undefined"==typeof b&&(b=a,a=b.url),b.url=a,akeebabackup.Ajax.requestArray.push(b),akeebabackup.Ajax.processQueue()},interpolateParameters:function interpolateParameters(a,b){b=b||"";var c="";for(var d in a)if(a.hasOwnProperty(d)){if(0<c.length&&(c+="&"),"object"!=typeof a[d]){c+=""===b?encodeURIComponent(d)+"="+encodeURIComponent(a[d]):encodeURIComponent(b)+"["+encodeURIComponent(d)+"]="+encodeURIComponent(a[d]);continue}c+=akeebabackup.Ajax.interpolateParameters(a[d],d)}return c},triggerCallbacks:function triggerCallbacks(){var a=Array.prototype.slice.call(arguments),b=a.shift();if("function"==typeof b)return b.apply(null,a);if(b instanceof Array)for(var c,d=0;d<b.length;d++)if(c=b[d],!1===c.apply(null,a))return!1;return null},processQueueHelper:function processQueueHelper(){akeebabackup.Ajax.processingQueue=!1,setTimeout(akeebabackup.Ajax.processQueue,50)},processQueue:function processQueue(){if(!akeebabackup.Ajax.requestArray.length)return void(akeebabackup.Ajax.processingQueue=!1);if(!akeebabackup.Ajax.processingQueue){var a=akeebabackup.Ajax.requestArray.shift(),b=a.url,c="undefined"==typeof a.success?[]:a.success,d="undefined"==typeof a.error?[]:a.error;"object"==typeof c&&c instanceof Array||(c=[c]),"object"==typeof d&&d instanceof Array||(d=[d]),c.unshift(akeebabackup.Ajax.processQueueHelper),d.unshift(akeebabackup.Ajax.processQueueHelper),a.success=c,a.error=d,akeebabackup.Ajax.processingQueue=!0,akeebabackup.Ajax.ajax(b,a)}}},"undefined"==typeof akeebabackup.System&&(akeebabackup.System={notification:{hasDesktopNotification:!1,iconURL:"",askPermission:function askPermission(){var a=Joomla.getOptions("akeebabackup.System.notification.hasDesktopNotification",akeebabackup.System.notification.hasDesktopNotification);a&&void 0!==window.Notification&&("default"!==window.Notification.permission||window.Notification.requestPermission())},notify:function notify(a,b,c){if(void 0!==window.Notification&&"granted"===window.Notification.permission){void 0===c&&(c=5e3),void 0===b&&(b="");var d=new window.Notification(a,{body:b,icon:Joomla.getOptions("akeebabackup.System.notification.iconURL",akeebabackup.System.notification.iconURL)});0<c&&setTimeout(function(a){return function(){a.close()}}(d),c)}}},params:{AjaxURL:"",errorCallback:null,password:"",errorDialogId:"errorDialog",errorDialogMessageId:"errorDialogPre"},findElement:function findElement(a){return"undefined"==typeof a?null:null===a?null:("string"==typeof a&&(a=document.getElementById(a)),"object"==typeof a?a instanceof Element?a:null:null)},defaultErrorHandler:function defaultErrorHandler(a){null==a||"undefined"==typeof a||alert("An error has occurred\n"+a)},modalErrorHandler:function modalErrorHandler(a){var b=Joomla.getOptions("akeebabackup.System.params.errorDialogId",akeebabackup.System.params.errorDialogId),c=Joomla.getOptions("akeebabackup.System.params.errorDialogMessageId",akeebabackup.System.params.errorDialogMessageId),d=document.getElementById(b),e="error";if(null!=d){var f=document.getElementById(c);f.innerHTML=a,e=d.innerHTML}new window.bootstrap.Modal(d).show()},doAjax:function doAjax(a,b,c,d,e){null==d&&(d=!0);var f=new Date().getTime()/1e3,g=parseInt(f+"",10);a._cacheBustingJunk=Math.round(1e3*(f-g))/1e3,null==e&&(e=6e5);var h=Joomla.getOptions("akeebabackup.System.params.AjaxURL",akeebabackup.System.params.AjaxURL);a.hasOwnProperty("ajaxURL")&&(h=a.ajaxURL,delete a.url);var i=!0;a.hasOwnProperty("useTripleHash")&&(i=a.useTripleHash,delete a.useTripleHash);var j=!0;a.hasOwnProperty("parseResponseAsJSON")&&(j=a.parseResponseAsJSON,delete a.parseResponseAsJSON),null==c&&(c=Joomla.getOptions("akeebabackup.System.params.errorCallback",akeebabackup.System.params.errorCallback||akeebabackup.System.modalErrorHandler)),null==c&&(c=akeebabackup.System.defaultErrorHandler);var k={type:"POST",url:h,cache:!1,data:a,timeout:e,success:function success(a){var d="";if(i){var e=a.indexOf("###");if(-1===e)return a=akeebabackup.System.sanitizeErrorMessage(a),a="Invalid AJAX data: "+a,void c(a)}d=a,i&&(0!==e&&(d=a.substr(e)),d=d.substr(3),e=d.lastIndexOf("###"),d=d.substr(0,e));try{var f=JSON.parse(d)}catch(b){return d=akeebabackup.System.sanitizeErrorMessage(d),a=b.message+"\n<br/>\n<pre>\n"+d+"\n</pre>",void c(a)}b(f)},error:function error(a,b){var d=a.responseText?a.responseText:"",e="<strong>AJAX Loading Error</strong><br/>HTTP Status: "+a.status+" ("+a.statusText+")<br/>";e=e+"Internal status: "+b+"<br/>",e=e+"XHR ReadyState: "+a.readyState+"<br/>",e=e+"Raw server response:<br/>"+akeebabackup.System.sanitizeErrorMessage(d),c(e)}};return d?void akeebabackup.Ajax.enqueue(k):void akeebabackup.Ajax.ajax(k)},sanitizeErrorMessage:function sanitizeErrorMessage(a){return-1<a.indexOf("<script")&&(a="(HTML containing script tags)"),a},addEventListener:function addEventListener(a,b,c){a=akeebabackup.System.findElement(a);a&&a.addEventListener(b,c)},removeEventListener:function removeEventListener(a,b,c){a=akeebabackup.System.findElement(a);a&&a.removeEventListener(b,c)},triggerEvent:function triggerEvent(a,b){if(a=akeebabackup.System.findElement(a),!!a){var c=null;c=document.createEvent("Event"),c.initEvent(b,!0,!0),a.dispatchEvent(c)}},documentReady:function documentReady(){},iterateNodes:function iterateNodes(a,b,c){if("function"==typeof b&&("string"==typeof a&&(a=document.querySelectorAll(a)),0!==a.length)){var d,e;for(d=0;d<a.length;d++){if(e=a[d],"undefined"!=typeof c){b(e,c);continue}b(e)}}},assignDefaultErrorHandler:function assignDefaultErrorHandler(){akeebabackup.System.params.errorCallback=akeebabackup.System.modalErrorHandler;var a=Joomla.getOptions("akeebabackup.System.params.errorDialogId",akeebabackup.System.params.errorDialogId),b=Joomla.getOptions("akeebabackup.System.params.errorDialogMessageId",akeebabackup.System.params.errorDialogMessageId);if(""===a||null===a||""===b||null===b)return void(akeebabackup.System.params.errorCallback=akeebabackup.System.defaultErrorHandler);var c=document.getElementById(a),d=document.getElementById(b);(null===c||null===d)&&(akeebabackup.System.params.errorCallback=akeebabackup.System.defaultErrorHandler)},escapeHTML:function escapeHTML(a){return a.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;")},CommonEvents:{onEventSubmit:function onEventSubmit(a){var b,c=a.currentTarget,d=null!==(b=c.dataset.akeebasubmittarget)&&void 0!==b?b:"",e=document.forms.adminForm?document.forms.adminForm:null;return!(""!==d&&(e=document.getElementById(d)),!!e)||(e.submit(),a.preventDefault(),!1)},onClickConfirm:function onClickConfirm(a){var b,c=a.currentTarget,d=null!==(b=c.akeebaconfirmmessage)&&void 0!==b?b:"";if(""===d)return!0;var e=confirm(Joomla.Text._(d));return!!e||(a.preventDefault(),!1)},onEventOrderTable:function onEventOrderTable(a){a.currentTarget;return a.preventDefault(),Joomla.orderTable(),!1},init:function init(){akeebabackup.System.iterateNodes(".akeebaCommonEventsOnChangeSubmit",function(a){akeebabackup.System.addEventListener(a,"change",akeebabackup.System.CommonEvents.onEventSubmit)}),akeebabackup.System.iterateNodes(".akeebaCommonEventsOnClickSubmit",function(a){akeebabackup.System.addEventListener(a,"click",akeebabackup.System.CommonEvents.onEventSubmit)}),akeebabackup.System.iterateNodes(".akeebaCommonEventsOnClickConfirm",function(a){akeebabackup.System.addEventListener(a,"click",akeebabackup.System.CommonEvents.onClickConfirm)}),akeebabackup.System.iterateNodes(".akeebaCommonEventsOnChangeOrderTable",function(a){akeebabackup.System.addEventListener(a,"change",akeebabackup.System.CommonEvents.onEventOrderTable)})}}}),Math.uuid=Math.uuid||function(){var a=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];return function(b,c){var d=a,e=[];if(c=c||d.length,b)for(var f=0;f<b;f++)e[f]=d[0|Math.random()*c];else{var g;e[8]=e[13]=e[18]=e[23]="-",e[14]="4";for(var f=0;36>f;f++)e[f]||(g=0|16*Math.random(),e[f]=d[19===f?8|3&g:g])}return e.join("")}}(),function(a,b){function c(){if(!f){f=!0;for(var a=0;a<e.length;a++)e[a].fn.call(window,e[a].ctx);e=[]}}function d(){"complete"===document.readyState&&c()}a=a||"documentReady",b=b||akeebabackup.System;var e=[],f=!1,g=!1;b[a]=function(a,b){return f?void setTimeout(function(){a(b)},1):(e.push({fn:a,ctx:b}),"complete"===document.readyState||!document.attachEvent&&"interactive"===document.readyState)?void setTimeout(c,1):g?void 0:(g=!0,document.addEventListener?(document.addEventListener("DOMContentLoaded",c,!1),void window.addEventListener("load",c,!1)):void(document.attachEvent("onreadystatechange",d),window.attachEvent("onload",c)))}}("documentReady",akeebabackup.System),akeebabackup.System.documentReady(function(){akeebabackup.System.assignDefaultErrorHandler(),akeebabackup.System.iterateNodes(".akeebaGridViewCheckAll",function(a){akeebabackup.System.addEventListener(a,"click",function(){Joomla.checkAll(this)})}),akeebabackup.System.iterateNodes(".akeebaGridViewOrderTable",function(a){akeebabackup.System.addEventListener(a,"change",akeebabackup.System.orderTable)}),akeebabackup.System.iterateNodes(".akeebaGridViewAutoSubmitOnChange",function(a){akeebabackup.System.addEventListener(a,"change",function(){Joomla.submitForm()})}),akeebabackup.System.CommonEvents.init()});
//# sourceMappingURL=System.min.js.map