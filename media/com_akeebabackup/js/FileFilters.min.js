"use strict";if("undefined"==typeof akeebabackup)var akeebabackup={};"undefined"==typeof akeebabackup.Fsfilters&&(akeebabackup.Fsfilters={currentRoot:null}),akeebabackup.Fsfilters.activeRootChanged=function(){var a=document.getElementById("active_root"),b={};b.root=a.options[a.selectedIndex].value,b.crumbs=[],b.node="",akeebabackup.Fsfilters.load(b)},akeebabackup.Fsfilters.activeTabRootChanged=function(){var a=document.getElementById("active_root");akeebabackup.Fsfilters.loadTab(a.options[a.selectedIndex].value)},akeebabackup.Fsfilters.load=function(a){a.verb="list";var b=JSON.stringify(a),c={};c.action=b,akeebabackup.System.doAjax(c,function(a){akeebabackup.Fsfilters.render(a)},null,!1,15e3)},akeebabackup.Fsfilters.toggle=function(a,b,c,d){if(null==d&&(d=!0),null!=b){var e,f;if("1"==(null!==(e=b.dataset.loading)&&void 0!==e?e:"0"))return;b.dataset.loading="1";var g=b;d&&(g=b.querySelector("span"));var h=null!==(f=b.dataset.iconClass)&&void 0!==f?f:"";h||(b.dataset.iconClass=g.className),g.className="ak-toggle-button ak-toggle-button-spinning akeebabackup-rotate fa fa-sync-alt"}var i=JSON.stringify(a);akeebabackup.System.doAjax({action:i},function(e){if(null!=b){var f,h=null!==(f=b.dataset.iconClass)&&void 0!==f?f:null;h&&(g.className=h),"iconClass"in b.dataset&&delete b.dataset.iconClass,"loading"in b.dataset&&delete b.dataset.loading}!0===e.success?(null!=b&&d&&(!0==e.newstate?(b.classList.remove("btn-light"),b.classList.add("btn-warning")):(b.classList.remove("btn-warning"),b.classList.add("btn-light"))),null!=c&&c(e,b)):(null!=c&&c(e,b),akeebabackup.System.modalErrorHandler(Joomla.Text._("COM_AKEEBABACKUP_FILEFILTERS_LABEL_UIERRORFILTER").replace("%s",a.node)))},function(a){if(null!=b){var c;g.className=null!==(c=b.dataset.iconClass)&&void 0!==c?c:null,"iconClass"in b.dataset&&delete b.dataset.iconClass,"loading"in b.dataset&&delete b.dataset.loading}akeebabackup.System.params.errorCallback(a)},!0,15e3)},akeebabackup.Fsfilters.render=function(a){akeebabackup.Fsfilters.currentRoot=a.root;var b=akeebabackup.Fsfilters.renderCrumbs(a),c=document.getElementById("folders");if(c.innerHTML="",0<a.crumbs.length&&akeebabackup.Fsfilters.renderParentFolderElement(),0<Object.keys(a.folders).length){var d=["directories_all","skipdirs_all","skipfiles_all"],e=document.createElement("div");e.className="folder-header folder-container";for(var f,g=0;g<d.length;g++){f=d[g],q=document.createElement("span"),q.className="folder-icon-container btn btn-sm btn-dark me-1 hasTooltip",q.setAttribute("title",Joomla.Text._("COM_AKEEBABACKUP_FILEFILTERS_TYPE_"+f.toUpperCase()));var h="";"directories_all"===f?(h="fa-ban",q.insertAdjacentHTML("beforeend","<span class=\"ak-toggle-button fa fa-ban\"></span>")):"skipdirs_all"===f?(h="fa-folder",q.insertAdjacentHTML("beforeend","<span class=\"ak-toggle-button fa fa-folder\"></span>")):"skipfiles_all"===f?(h="fa-file",q.insertAdjacentHTML("beforeend","<span class=\"ak-toggle-button fa fa-file\"></span>")):void 0,q.addEventListener("click",function(a,b){return function(){var d;a.classList.contains("btn-warning")?(a.classList.remove("btn-warning"),a.classList.add("btn-dark"),d=!1):(a.classList.remove("btn-dark"),a.classList.add("btn-warning"),d=!0);for(var e=1;e<c.children.length;e++){var f=c.children[e],g=f.querySelector("span."+b),h=g.parentNode.classList.contains("btn-warning");(d||h)&&(!d||!h)&&akeebabackup.System.triggerEvent(g,"click")}}}(q,h)),e.appendChild(q)}var i=document.createElement("span");i.className="folder-name fst-italic",i.innerHTML="<span class=\"pull-left fa fa-arrow-down px-1\"></span>"+Joomla.Text._("COM_AKEEBABACKUP_FILEFILTERS_TYPE_APPLYTOALLDIRS"),e.appendChild(i),c.appendChild(e)}for(var j in a.folders){if(!a.folders.hasOwnProperty(j))return;var k=a.folders[j],l=document.createElement("div");l.className="folder-container d-flex my-1 py-1 border-top",t=["directories","skipdirs","skipfiles"];for(var m=0;m<t.length;m++){switch(f=t[m],q=document.createElement("span"),q.className="btn btn-sm btn-light me-1 hasTooltip folder-icon-container",q.setAttribute("title",Joomla.Text._("COM_AKEEBABACKUP_FILEFILTERS_TYPE_"+f.toUpperCase())),("directories"===f?q.insertAdjacentHTML("beforeend","<span class=\"ak-toggle-button fa fa-ban\"></span>"):"skipdirs"===f?q.insertAdjacentHTML("beforeend","<span class=\"ak-toggle-button fa fa-folder\"></span>"):"skipfiles"===f?q.insertAdjacentHTML("beforeend","<span class=\"ak-toggle-button fa fa-file\"></span>"):void 0,k[f])){case 2:q.classList.remove("btn-light"),q.classList.add("btn-danger");break;case 1:q.classList.remove("btn-light"),q.classList.add("btn-warning");case 0:q.addEventListener("click",function(c,d,e){return function(){var f={root:a.root,crumbs:b,node:c,filter:d,verb:"toggle"};akeebabackup.Fsfilters.toggle(f,e)}}(j,f,q));}l.appendChild(q)}var n=document.createElement("span");n.textContent=j,k.link&&(n.innerHTML="<span class=\"fa fa-link\" aria-hidden=\"true\"></span> "+n.innerHTML),n.className="folder-name",n.addEventListener("click",function(c){return function(){var d=document.createElement("img");d.setAttribute("src",Joomla.getOptions("akeebabackup.Fsfilters.loadingGif","")),d.setAttribute("width",16),d.setAttribute("height",11),d.setAttribute("border",0),d.setAttribute("alt","Loading..."),d.style.marginTop="3px",d.style.marginLeft="5px",this.appendChild(d);var e={root:a.root,crumbs:b,node:c};akeebabackup.Fsfilters.load(e)}}(j)),l.appendChild(n),c.appendChild(l)}var o=document.getElementById("files");if(o.innerHTML="",0<Object.keys(a.files).length){var p=document.createElement("div");p.className="file-header file-container";var q=document.createElement("span");q.className="file-icon-container btn btn-sm btn-dark me-1 hasTooltip",q.insertAdjacentHTML("beforeend","<span class=\"ak-toggle-button fa fa-ban\"></span>"),q.setAttribute("title",Joomla.Text._("COM_AKEEBABACKUP_FILEFILTERS_TYPE_FILES_ALL")),q.addEventListener("click",function(){return function(){var a;this.classList.contains("btn-warning")?(this.classList.remove("btn-warning"),this.classList.add("btn-dark"),a=!1):(this.classList.remove("btn-dark"),this.classList.add("btn-warning"),a=!0);for(var b=document.getElementById("files"),c=1;c<b.children.length;c++){var d=b.children[c],e=d.querySelector("span.fa-ban"),f=e.parentNode.classList.contains("btn-warning");(a||f)&&(!a||!f)&&akeebabackup.System.triggerEvent(e,"click")}}}(q)),p.appendChild(q);var r=document.createElement("span");r.className="file-name",r.innerHTML="<span class=\"pull-left akion-arrow-down-a\"></span>"+Joomla.Text._("COM_AKEEBABACKUP_FILEFILTERS_TYPE_APPLYTOALLFILES"),p.appendChild(r),o.appendChild(p)}for(var s in a.files)if(a.files.hasOwnProperty(s)){k=a.files[s],l=document.createElement("div"),l.className="file-container d-flex my-1 py-1 border-top";for(var t=["files"],u=0;u<t.length;u++){switch(f=t[u],q=document.createElement("span"),q.className="file-icon-container btn btn-sm btn-light me-1 hasTooltip","files"===f?q.insertAdjacentHTML("beforeend","<span class=\"ak-toggle-button fa fa-ban\"></span>"):void 0,(q.setAttribute("title",Joomla.Text._("COM_AKEEBABACKUP_FILEFILTERS_TYPE_"+f.toUpperCase())),k[f])){case 2:q.classList.remove("btn-light"),q.classList.add("btn-danger");break;case 1:q.classList.remove("btn-light"),q.classList.add("btn-warning");case 0:q.addEventListener("click",function(c,d,e){return function(){var f={root:a.root,crumbs:b,node:c,filter:d,verb:"toggle"};akeebabackup.Fsfilters.toggle(f,e)}}(s,f,q));}l.appendChild(q)}var v=document.createElement("span");v.className="file-name flex-grow-1",v.textContent=s,k.link&&(v.innerHTML="<span class=\"akion-link\" aria-hidden=\"true\"></span> "+v.innerHTML),l.appendChild(v);var w=document.createElement("span");w.className="file-size text-muted fst-italic",w.textContent=k.size,l.appendChild(w),o.appendChild(l)}},akeebabackup.Fsfilters.nuke=function(){var a={root:akeebabackup.Fsfilters.currentRoot,verb:"reset"},b={action:JSON.stringify(a)};akeebabackup.System.doAjax(b,function(a){akeebabackup.Fsfilters.render(a)},null,!1,15e3)},akeebabackup.Fsfilters.loadTab=function(a){var b={action:JSON.stringify({verb:"tab",root:a})};akeebabackup.System.doAjax(b,function(a){akeebabackup.Fsfilters.renderTab(a)},null,!1,15e3)},akeebabackup.Fsfilters.addRow=function(a,b){var c=Joomla.Text._("COM_AKEEBABACKUP_FILEFILTERS_TYPE_"+a.type.toUpperCase());null==c&&(c=a.type);var d=document.createElement("tr");d.className="ak_filter_row";var e=document.createElement("td");d.appendChild(e),e.className="ak_filter_type",e.insertAdjacentHTML("beforeend",c);var f=document.createElement("td");d.appendChild(f),f.className="ak_filter_item";var g=document.createElement("span");f.appendChild(g),g.className="ak_filter_tab_icon_container btn btn-sm btn-danger me-2 deletecontainer",g.addEventListener("click",function(){if(""==a.node){var b=this.parentNode.parentNode;return void b.parentNode.removeChild(b)}var c=document.getElementById("active_root"),d={root:c.options[c.selectedIndex].value,crumbs:[],node:a.node,filter:a.type,verb:"toggle"};akeebabackup.Fsfilters.toggle(d,this,function(a,b){if(a.success){var c=b.parentNode.parentNode;c.parentNode.removeChild(c)}})}),g.insertAdjacentHTML("beforeend","<span class=\"ak-toggle-button fa fa-trash deletebutton\"></span>");var h=document.createElement("span");f.appendChild(h),h.className="ak_filter_tab_icon_container btn btn-sm btn-primary me-1 editcontainer",h.addEventListener("click",function(){var b=this.parentNode.querySelector("input");if(null==b){this.parentNode.querySelector("span.ak_filter_name").style.display="none";var c=document.createElement("input");c.className="form-input",c.setAttribute("type","text"),c.setAttribute("size",60),c.value=this.parentNode.querySelector("span.ak_filter_name").textContent,this.parentNode.appendChild(c),c.addEventListener("blur",function(){var b=this.value,c=this;if(""==b)return void akeebabackup.System.triggerEvent(c.parentNode.querySelector("span.deletebutton"),"click");var d=document.getElementById("active_root"),e={root:d.options[d.selectedIndex].value,crumbs:[],old_node:a.node,new_node:b,filter:a.type,verb:"swap"},f=c.parentNode.querySelector("span.editcontainer");akeebabackup.Fsfilters.toggle(e,f,function(){var d=c.parentNode.querySelector("span.ak_filter_name");d.style.display="inline-block",d.textContent=b,c.parentNode.removeChild(c),a.node=b})}),c.focus()}}),h.insertAdjacentHTML("beforeend","<span class=\"ak-toggle-button fa fa-edit editbutton\"></span>");var i=document.createElement("span");i.className="ak_filter_name",i.textContent=a.node,f.appendChild(i),b.appendChild(d)},akeebabackup.Fsfilters.addNew=function(a){akeebabackup.Fsfilters.addRow({type:a,node:""},document.getElementById("ak_list_table").children[1]);var b=document.getElementById("ak_list_table").children[1].children,c=b[b.length-1];akeebabackup.System.triggerEvent(c.querySelector("span.editcontainer"),"click")},akeebabackup.Fsfilters.renderTab=function(a){var b=document.getElementById("ak_list_contents");b.innerHTML="";for(var c,d=0;d<a.length;d++)c=a[d],akeebabackup.Fsfilters.addRow(c,b)},akeebabackup.Fsfilters.renderCrumbs=function(a){var b=[],c=[Joomla.Text._("COM_AKEEBABACKUP_FILEFILTERS_LABEL_UIROOT"),a.root,[],""];b.push(c);var d=0;if(0<a.crumbs.length){var e=[];for(d=0;d<a.crumbs.length;d++){var f=a.crumbs[d];c=[f,a.root,e.slice(0),f],b.push(c),e.push(f)}}var g=document.getElementById("ak_crumbs");g.innerHTML="";var h=null;for(d=0;d<b.length;d++){h=b[d];var i=document.createElement("li"),j=document.createElement("a");i.className="breadcrumb-item",1==b.length-d&&(i.className+=" active"),h[0]=h[0].replace("&lt;","<").replace("&gt;",">"),j.textContent=h[0],j.setAttribute("type","button"),j.addEventListener("click",function(a){return function(){var b=document.createElement("img");b.setAttribute("src",Joomla.getOptions("akeebabackup.Fsfilters.loadingGif","")),b.setAttribute("width",16),b.setAttribute("height",11),b.setAttribute("border",0),b.setAttribute("alt","Loading..."),b.className="p-3",this.appendChild(b);var c={root:a[1],crumbs:a[2],node:a[3]};akeebabackup.Fsfilters.load(c)}}(h)),i.appendChild(j),g.appendChild(i)}return e},akeebabackup.Fsfilters.renderParentFolderElement=function(){var a=document.getElementById("folders"),b=document.createElement("div");b.className="folder-container folder-header",b.insertAdjacentHTML("beforeend","<span class=\"folder-padding\"></span>"),b.insertAdjacentHTML("beforeend","<span class=\"folder-padding\"></span>"),b.insertAdjacentHTML("beforeend","<span class=\"folder-padding\"></span>"),b.insertAdjacentHTML("beforeend","<span class=\"akion-arrow-up-a\"></span>");var c=document.createElement("span");c.className="folder-name folder-up";var d=document.getElementById("ak_crumbs").children,e=d[d.length-2].querySelector("a");c.textContent=" ("+e.textContent+")",c.addEventListener("click",function(a){return function(){akeebabackup.System.triggerEvent(a,"click")}}(e)),b.appendChild(c),a.appendChild(b)},akeebabackup.Fsfilters.initTooltips=function(){var a=Joomla.getOptions("bootstrap.tooltip");"object"!=typeof a||null===a||Object.keys(a).forEach(function(b){var c=a[b],d=Array.from(document.querySelectorAll(b));d.length&&d.map(function(a){new window.bootstrap.Tooltip(a,c)})})},akeebabackup.System.documentReady(function(){var a=Joomla.getOptions("akeebabackup.Filefilters.guiData",null),b=Joomla.getOptions("akeebabackup.Filefilters.viewType",null),c=document.getElementById("active_root");null!==a&&("list"===b?(akeebabackup.Fsfilters.render(a),c.addEventListener("change",akeebabackup.Fsfilters.activeRootChanged),document.getElementById("comAkeebaFilefiltersNuke").addEventListener("click",function(){return akeebabackup.Fsfilters.nuke(),!1})):"tabular"===b?(akeebabackup.Fsfilters.renderTab(a),c.addEventListener("change",akeebabackup.Fsfilters.activeTabRootChanged),document.getElementById("comAkeebaFilefiltersAddDirectories").addEventListener("click",function(){return akeebabackup.Fsfilters.addNew("directories"),!1}),document.getElementById("comAkeebaFilefiltersAddSkipfiles").addEventListener("click",function(){return akeebabackup.Fsfilters.addNew("skipfiles"),!1}),document.getElementById("comAkeebaFilefiltersAddSkipdirs").addEventListener("click",function(){return akeebabackup.Fsfilters.addNew("skipdirs"),!1}),document.getElementById("comAkeebaFilefiltersAddFiles").addEventListener("click",function(){return akeebabackup.Fsfilters.addNew("files"),!1})):void 0,akeebabackup.Fsfilters.initTooltips())});
//# sourceMappingURL=FileFilters.min.js.map