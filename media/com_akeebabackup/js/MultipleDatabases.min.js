"use strict";if("undefined"==typeof akeebabackup)var akeebabackup={};"undefined"==typeof akeebabackup.Multidb&&(akeebabackup.Multidb={modalDialog:null}),akeebabackup.Multidb.render=function(a){var b=document.getElementById("ak_list_contents");for(var c in b.innerHTML="",a)if(a.hasOwnProperty(c)){var d=a[c];akeebabackup.Multidb.addRow(c,d,b)}akeebabackup.Multidb.addNewRecordButton(b)},akeebabackup.Multidb.addRow=function(a,b,c){var d=document.createElement("tr");d.className="ak_filter_row",d.dataset.root=a,d.dataset.def=JSON.stringify(b);var e=document.createElement("td");e.style.width="2em";var f=document.createElement("span");f.className="ak_filter_tab_icon_container btn btn-danger btn-sm",f.addEventListener("click",function(){var a=this.parentNode.parentNode,b={root:a.dataset.root,verb:"remove"};akeebabackup.Fsfilters.toggle(b,this,function(a,b){if(!0===a.success){var c=b.parentNode.parentNode;c.parentNode.removeChild(c)}})});var g=document.createElement("span");g.className="ak-toggle-button deletebutton",g.insertAdjacentHTML("beforeend","<span class=\"fa fa-trash\"></span>"),f.appendChild(g),e.appendChild(f);var h=document.createElement("td");h.style.width="2em";var i=document.createElement("span");i.className="ak_filter_tab_icon_container btn btn-primary btn-sm",i.addEventListener("click",function(){var b,c=this.parentNode.parentNode,d=JSON.parse(null!==(b=c.dataset.def)&&void 0!==b?b:"{}"),e=c.dataset.root,f=document.getElementById("akEditorDialog");""===d.driver&&(d.driver="mysqli"),document.getElementById("ake_driver").value=d.driver,document.getElementById("ake_host").value=d.host,document.getElementById("ake_username").value=d.username,document.getElementById("ake_password").value=d.password,document.getElementById("ake_database").value=d.database,document.getElementById("ake_prefix").value=d.prefix;try{var g=document.getElementById("ak_editor_notifier");g.parentNode.removeChild(g)}catch(a){}var h=document.getElementById("akEditorBtnDefault"),i=h.cloneNode(!0);h.parentNode.replaceChild(i,h),i.addEventListener("click",function(){try{var b=document.getElementById("ak_editor_notifier");b.parentNode.removeChild(b)}catch(a){}var c=document.createElement("div");c.className="alert alert-info",c.id="ak_editor_notifier";var d=document.createElement("p");d.id="ak_editor_notifier_content",c.appendChild(d);var e=document.createElement("img");e.setAttribute("border",0),e.setAttribute("src",Joomla.getOptions("akeebabackup.Multidb.loadingGif","")),d.appendChild(e);var f=document.createElement("span");f.textContent=Joomla.Text._("COM_AKEEBABACKUP_MULTIDB_GUI_LBL_LOADING"),d.appendChild(f);var g=document.getElementById("ak_editor_table");g.insertAdjacentHTML("beforebegin",c.outerHTML);var h=document.getElementById("ake_driver"),i=h.options[h.selectedIndex],j=null==i?"":i.value,k={verb:"test",root:a,data:{host:document.getElementById("ake_host").value,driver:j,port:document.getElementById("ake_port").value,user:document.getElementById("ake_username").value,password:document.getElementById("ake_password").value,database:document.getElementById("ake_database").value,prefix:document.getElementById("ake_prefix").value}},l={action:JSON.stringify(k)};akeebabackup.System.doAjax(l,function(a){var b=document.getElementById("ak_editor_notifier_content");!0===a.status?(document.getElementById("ak_editor_notifier").className="alert alert-success",b.textContent=Joomla.Text._("COM_AKEEBABACKUP_MULTIDB_GUI_LBL_CONNECTOK")):(document.getElementById("ak_editor_notifier").className="alert alert-danger",b.innerHTML=Joomla.Text._("COM_AKEEBABACKUP_MULTIDB_GUI_LBL_CONNECTFAIL")+"<br/><code>"+a.message+"</code>")},function(a){var b=document.getElementById("ak_editor_notifier_content");document.getElementById("ak_editor_notifier").className="alert alert-danger",b.textContent=Joomla.Text._("COM_AKEEBABACKUP_MULTIDB_GUI_LBL_CONNECTFAIL"),"object"==typeof akeebabackup.Multidb.modalDialog&&akeebabackup.Multidb.modalDialog.hide&&akeebabackup.Multidb.modalDialog.hide(),akeebabackup.System.params.errorCallback(a)},!1,15e3)});var j=document.getElementById("akEditorBtnSave"),k=j.cloneNode(!0);j.parentNode.replaceChild(k,j),k.addEventListener("click",function(){try{var b=document.getElementById("ak_editor_notifier");b.parentNode.removeChild(b)}catch(a){}var d=document.createElement("div");d.className="alert alert-info",d.id="ak_editor_notifier";var e=document.createElement("p");e.id="ak_editor_notifier_content",d.appendChild(e);var f=document.createElement("img");f.setAttribute("border",0),f.setAttribute("src",Joomla.getOptions("akeebabackup.Multidb.loadingGif","")),e.appendChild(f);var g=document.createElement("span");g.textContent=Joomla.Text._("COM_AKEEBABACKUP_MULTIDB_GUI_LBL_LOADING"),e.appendChild(g);var h=document.getElementById("ak_editor_table");h.insertAdjacentHTML("beforebegin",d.outerHTML);var i=document.getElementById("ake_driver"),j=i.options[i.selectedIndex],k=null==j?"":j.value,l={verb:"set",root:a,data:{host:document.getElementById("ake_host").value,driver:k,port:document.getElementById("ake_port").value,username:document.getElementById("ake_username").value,password:document.getElementById("ake_password").value,database:document.getElementById("ake_database").value,prefix:document.getElementById("ake_prefix").value,dumpFile:(a+"").substr(0,9)+document.getElementById("ake_database").value+".sql"}};if(!l.data.host.length&&!l.data.database.length)return void akeebabackup.System.triggerEvent("akEditorBtnCancel","click");var m={action:JSON.stringify(l)};akeebabackup.System.doAjax(m,function(a){if(!0!=a)return void(document.getElementById("ak_editor_notifier_content").textContent=Joomla.Text._("COM_AKEEBABACKUP_MULTIDB_GUI_LBL_SAVEFAIL"));c.dataset.def=JSON.stringify(l.data);c.querySelectorAll("td");if(c.querySelector("span.ak_dbhost").textContent=l.data.host,c.querySelector("span.ak_dbname").textContent=l.data.database,!c.querySelector("span.editbutton").firstChild.classList.contains("fa-edit")){c.querySelector("span.deletebutton").parentNode.style.display="inline-block";var b=c.querySelector("span.editbutton");b.firstChild.className="fa fa-edit",akeebabackup.Multidb.addNewRecordButton(c.parentNode)}"object"==typeof akeebabackup.Multidb.modalDialog&&akeebabackup.Multidb.modalDialog.hide&&akeebabackup.Multidb.modalDialog.hide()},function(a){document.getElementById("ak_editor_notifier_content").textContent=Joomla.Text._("COM_AKEEBABACKUP_MULTIDB_GUI_LBL_SAVEFAIL"),"object"==typeof akeebabackup.Multidb.modalDialog&&akeebabackup.Multidb.modalDialog.hide&&akeebabackup.Multidb.modalDialog.hide(),akeebabackup.System.params.errorCallback(a)},!1,15e3)});var l=document.getElementById("akEditorBtnCancel"),m=l.cloneNode(!0);l.parentNode.replaceChild(m,l),m.addEventListener("click",function(){"object"==typeof akeebabackup.Multidb.modalDialog&&akeebabackup.Multidb.modalDialog.hide&&akeebabackup.Multidb.modalDialog.hide()}),akeebabackup.Multidb.modalDialog=new bootstrap.Modal(f,{keyboard:!0,backdrop:!0}),akeebabackup.Multidb.modalDialog.show(),akeebabackup.System.triggerEvent(f.querySelector("span"),"focus")});var j=document.createElement("span");j.className="editbutton ak-toggle-button",j.insertAdjacentHTML("beforeend","<span class=\"fa fa-edit\"></span>"),i.appendChild(j),h.appendChild(i);var k=document.createElement("td");k.className="ak_filter_item";var l=document.createElement("span");l.className="ak_filter_name ak_dbhost",l.textContent=b.host,k.appendChild(l);var m=document.createElement("td");m.className="ak_filter_item";var n=document.createElement("span");n.className="ak_filter_name ak_dbname",n.textContent=b.database,m.appendChild(n),d.appendChild(e),d.appendChild(h),d.appendChild(k),d.appendChild(m),c.appendChild(d)},akeebabackup.Multidb.addNewRecordButton=function(a){var b=Math.uuid();akeebabackup.Multidb.addRow(b,{host:"",port:"",username:"",password:"",database:"",prefix:""},a);var c=document.getElementById("ak_list_contents").children,d=c[c.length-1],e=d.querySelectorAll("td");e[0].querySelector("span").style.display="none";var f=e[1].querySelectorAll("span"),g=f[f.length-1];g.className="fa fa-plus-circle"},akeebabackup.System.documentReady(function(){akeebabackup.Multidb.render(Joomla.getOptions("akeebabackup.Multidb.guiData",{}))});
//# sourceMappingURL=MultipleDatabases.min.js.map