"use strict";if("undefined"==typeof akeebabackup)var akeebabackup={};"undefined"==typeof akeebabackup.Dbfilters&&(akeebabackup.Dbfilters={currentRoot:null}),akeebabackup.Dbfilters.activeRootChanged=function(){var a=document.getElementById("active_root"),b={root:a.options[a.selectedIndex].value};akeebabackup.Dbfilters.load(b)},akeebabackup.Dbfilters.activeTabRootChanged=function(){var a=document.getElementById("active_root");akeebabackup.Dbfilters.loadTab(a.options[a.selectedIndex].value)},akeebabackup.Dbfilters.load=function(a){a.verb="list";var b={action:JSON.stringify(a)};akeebabackup.System.doAjax(b,function(a){akeebabackup.Dbfilters.render(a)},null,!1,15e3)},akeebabackup.Dbfilters.toggle=function(a,b,c){akeebabackup.Fsfilters.toggle(a,b,c)},akeebabackup.Dbfilters.render=function(a){akeebabackup.Dbfilters.currentRoot=a.root;var b=document.getElementById("tables");for(var c in b.innerHTML="",a.tables)if(a.tables.hasOwnProperty(c)){var d=a.tables[c],e=document.createElement("div");e.className="table-container d-flex my-1 py-1 border-bottom";for(var f=["tables","tabledata"],g=0;g<f.length;g++){var h=f[g],i=document.createElement("span");switch(i.className="table-icon-container btn btn-sm btn-light me-1 hasTooltip",i.setAttribute("title",Joomla.Text._("COM_AKEEBABACKUP_DBFILTER_TYPE_"+h.toUpperCase())),("tables"===h?i.insertAdjacentHTML("beforeend","<span class=\"ak-toggle-button fa fa-ban\"></span>"):"tabledata"===h?i.insertAdjacentHTML("beforeend","<span class=\"ak-toggle-button fa fa-database\"></span>"):void 0,d[h])){case 2:i.classList.remove("btn-light"),i.classList.add("btn-danger");break;case 1:i.classList.remove("btn-light"),i.classList.add("btn-warning");case 0:i.addEventListener("click",function(b,c,d){return function(){var e={root:a.root,node:c,filter:d,verb:"toggle"};akeebabackup.Dbfilters.toggle(e,b)}}(i,c,h));}e.appendChild(i)}var j="akion-link",k="COM_AKEEBABACKUP_DBFILTER_TABLE_MISC";switch(d.type){case"table":j="fa fa-table",k="COM_AKEEBABACKUP_DBFILTER_TABLE_TABLE";break;case"view":j="fa fa-th-list",k="COM_AKEEBABACKUP_DBFILTER_TABLE_VIEW";break;case"procedure":j="fa fa-cube",k="COM_AKEEBABACKUP_DBFILTER_TABLE_PROCEDURE";break;case"function":j="fa fa-code",k="COM_AKEEBABACKUP_DBFILTER_TABLE_FUNCTION";break;case"trigger":j="fa fa-bolt",k="COM_AKEEBABACKUP_DBFILTER_TABLE_TRIGGER";break;case"temp":case"memory":j="fa fa-ghost",k="COM_AKEEBABACKUP_DBFILTER_TABLE_TEMP";break;default:j="fa fa-question-circle",k="COM_AKEEBABACKUP_DBFILTER_TABLE_UNKNOWN";}var l=document.createElement("span"),m=document.createElement("span"),n=document.createElement("span"),o=document.createElement("span");l.className="table-name flex-grow-1",l.textContent=c,m.className="table-rowcount text-muted fst-italic",d.rows&&(m.textContent=d.rows,m.setAttribute("title",Joomla.Text._("COM_AKEEBABACKUP_DBFILTER_TABLE_META_ROWCOUNT"))),n.className="table-icon-container table-icon-noclick table-icon-small hasTooltip",n.setAttribute("title",Joomla.Text._(k,d.type));var p=document.createElement("span");p.className=j+" me-2",n.appendChild(p),o.className="table-icon-container table-icon-noclick table-icon-small";var q=document.createElement("span");q.className="fa fa-ellipsis-v mx-2",q.style.color="#cccccc",o.appendChild(q),e.appendChild(o),e.appendChild(n),e.appendChild(l),e.appendChild(m),b.appendChild(e)}},akeebabackup.Dbfilters.loadTab=function(a){var b={action:JSON.stringify({verb:"tab",root:a})};akeebabackup.System.doAjax(b,function(a){akeebabackup.Dbfilters.renderTab(a)},null,!1,15e3)},akeebabackup.Dbfilters.addRow=function(a,b){var c=Joomla.Text._("COM_AKEEBABACKUP_DBFILTER_TYPE_"+a.type.toUpperCase());null==c&&(c=a.type);var d=document.createElement("tr"),e=document.createElement("td"),f=document.createElement("td");d.className="ak_filter_row",e.className="ak_filter_type",e.textContent=c,f.className="ak_filter_item";var g=document.createElement("span"),h=document.createElement("span"),i=document.createElement("span");g.className="ak_filter_tab_icon_container btn btn-sm btn-danger me-2",g.addEventListener("click",function(){if(""==a.node){var b=this.parentNode.parentNode;return void b.parentNode.removeChild(b)}var c=document.getElementById("active_root"),d={root:c.options[c.selectedIndex].value,node:a.node,filter:a.type,verb:"remove"};akeebabackup.Dbfilters.toggle(d,this,function(a,b){if(a.success){var c=b.parentNode.parentNode;c.parentNode.removeChild(c)}})});var j=document.createElement("span");j.className="ak-toggle-button icon-trash deletebutton",g.appendChild(j),h.className="ak_filter_tab_icon_container btn btn-sm btn-primary me-2",h.addEventListener("click",function(){var b=this.parentNode.querySelector("input");if(null==b){this.parentNode.querySelector("span.ak_filter_name").style.display="none";var c=document.createElement("input");c.className="form-input",c.setAttribute("type","text"),c.setAttribute("size",60),c.value=this.parentNode.querySelector("span.ak_filter_name").textContent,this.parentNode.appendChild(c),c.addEventListener("blur",function(){var b=this.value,c=this;if(""==b)return void akeebabackup.System.triggerEvent(c.parentNode.querySelector("span.deletebutton"),"click");var d=document.getElementById("active_root"),e={root:d.options[d.selectedIndex].value,old_node:a.node,new_node:b,filter:a.type,verb:"swap"},f=c.parentNode.querySelector("span.editcontainer");akeebabackup.Dbfilters.toggle(e,f,function(){var d=c.parentNode.querySelector("span.ak_filter_name");d.style.display="inline-block",d.textContent=b,c.parentNode.removeChild(c),a.node=b})}),c.focus()}});var k=document.createElement("span");k.className="ak-toggle-button fa fa-edit editbutton",h.appendChild(k),i.className="ak_filter_name",i.textContent=a.node,f.appendChild(g),f.appendChild(h),f.appendChild(i),d.appendChild(e),d.appendChild(f),b.appendChild(d)},akeebabackup.Dbfilters.addNew=function(a){akeebabackup.Dbfilters.addRow({type:a,node:""},document.getElementById("ak_list_table").children[1]);var b=document.getElementById("ak_list_table").children[1].children,c=b[b.length-1];akeebabackup.System.triggerEvent(c.querySelector("span.editbutton"),"click")},akeebabackup.Dbfilters.renderTab=function(a){var b=document.getElementById("ak_list_contents");b.innerHTML="";for(var c,d=0;d<a.length;d++)c=a[d],akeebabackup.Dbfilters.addRow(c,b)},akeebabackup.Dbfilters.excludeNonCMS=function(){for(var a=document.getElementById("tables").children,b=0;b<a.length;b++){var c=a[b],d=c.querySelector("span.table-name").textContent,e=d.substr(0,3);if("#__"!==e){var f=c.querySelector("span.table-icon-container"),g=f.querySelector("span.ak-toggle-button");f.classList.contains("btn-warning")||f.classList.contains("btn-danger")||akeebabackup.System.triggerEvent(g,"click")}}},akeebabackup.Dbfilters.nuke=function(){var a={root:akeebabackup.Dbfilters.currentRoot,verb:"reset"},b={action:JSON.stringify(a)};akeebabackup.System.doAjax(b,function(a){akeebabackup.Dbfilters.render(a)},null,!1,15e3)},akeebabackup.System.documentReady(function(){var a=Joomla.getOptions("akeebabackup.Databasefilters.guiData",null),b=Joomla.getOptions("akeebabackup.Databasefilters.viewType",null),c=document.getElementById("active_root");"list"===b?(c.addEventListener("change",akeebabackup.Dbfilters.activeRootChanged),akeebabackup.Dbfilters.render(a),document.getElementById("comAkeebaDatabasefiltersExcludeNonCMS").addEventListener("click",function(){return akeebabackup.Dbfilters.excludeNonCMS(),!1}),document.getElementById("comAkeebaDatabasefiltersNuke").addEventListener("click",function(){return akeebabackup.Dbfilters.nuke(),!1})):"tabular"===b?(c.addEventListener("change",akeebabackup.Dbfilters.activeTabRootChanged),akeebabackup.Dbfilters.renderTab(a),document.getElementById("comAkeebaDatabasefiltersAddNewTables").addEventListener("click",function(){return akeebabackup.Dbfilters.addNew("tables"),!1}),document.getElementById("comAkeebaDatabasefiltersAddNewTableData").addEventListener("click",function(){return akeebabackup.Dbfilters.addNew("tabledata"),!1})):void 0;akeebabackup.Fsfilters.initTooltips()});
//# sourceMappingURL=DatabaseFilters.min.js.map